<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/sd_card" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">SPI_SDCARD实验 | 正点原子在线文档</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wiki.alientek.com/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wiki.alientek.com/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://wiki.alientek.com/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/sd_card"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SPI_SDCARD实验 | 正点原子在线文档"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wiki.alientek.com/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/sd_card"><link data-rh="true" rel="alternate" href="https://wiki.alientek.com/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/sd_card" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://wiki.alientek.com/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/sd_card" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.befeb1dc.css">
<script src="/assets/js/runtime~main.d2795927.js" defer="defer"></script>
<script src="/assets/js/main.f4c1d837.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ALIENTEK</b></a><a href="http://www.alientek.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">官网<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="http://www.openedv.com/forum.php" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">论坛<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Boards/RaspberryPi/DNRP2350A/TOC">目录</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/入门指南-11">入门指南</a><button aria-label="展开侧边栏分类 &#x27;入门指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/sdk使用指南-3">SDK使用指南</a><button aria-label="折叠侧边栏分类 &#x27;SDK使用指 南&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/dnrp2350am-sdk-dev">VSCode环境部署与新建工程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/ch32-driver">CH343 驱动安装</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/sdk基础实验-3">SDK基础实验</a><button aria-label="折叠侧边栏分类 &#x27;SDK基础实验&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/led">LED灯实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/key">按键输入实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/exit">外部中断实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/uart">串口实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/pio">PIO实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/timg">定时器实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/wdt">看门狗实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/pwm">PWM实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/dma">DMA实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/adc">ADC实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/internal_temperature">内部温度传感器实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/lcd">SPI-LCD实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/rtc">RTC实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/trng">TRNG随机数实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/sd_card">SPI_SDCARD实验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/usb">USB虚拟串口实验</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/micropython使用指南-6">MicroPython使用指南</a><button aria-label="展开侧边栏分类 &#x27;MicroPython使用指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/sdk使用指南-3"><span itemprop="name">SDK使用指南</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/sdk基础实验-3"><span itemprop="name">SDK基础实验</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SPI_SDCARD实验</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>SPI_SDCARD实验</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="#前言" class="hash-link" aria-label="前言的直接链接" title="前言的直接链接">​</a></h2>
<p>很多单片机系统都需要大容量存储设备，以存储数据。目前常用的有U盘，FLASH芯片，SD卡等。他们各有优点，综合比较，最适合单片机系统的莫过于SD卡了，它不仅容量可以做到很大（32GB以上），支持SPI/SDIO驱动，而且有多种体积的尺寸可供选择（标准的SD卡尺寸及Micro SD卡尺寸等），能满足不同应用的要求。只需要少数几个IO口即可外扩一个高达32GB或以上的外部存储器，容量从几十M到几十G选择范围很大，更换也很方便，编程也简单，是单片机大容量外部存储器的首选。
正点原子DNRP2350AM最小系统板使用的接口是Micro SD卡接口，卡座带自锁功能。SPI主机驱动程序将处理来自不同任务的独占访问。在本章中，我们将向大家介绍，如何在正点原子DNRP2350AM系统板上实现Micro SD卡的读取。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sd卡简介">SD卡简介<a href="#sd卡简介" class="hash-link" aria-label="SD卡简介的直接链接" title="SD卡简介的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1sd卡物理结构">1，SD卡物理结构<a href="#1sd卡物理结构" class="hash-link" aria-label="1，SD卡物理结构的直接链接" title="1，SD卡物理结构的直接链接">​</a></h3>
<p>SD卡的规范由SD卡协会明确，可以访问<a href="https://www.sdcard.org%E6%9F%A5%E9%98%85%E6%9B%B4%E5%A4%9A%E6%A0%87%E5%87%86%E3%80%82SD%E5%8D%A1%E4%B8%BB%E8%A6%81%E6%9C%89SD%E3%80%81Mini" target="_blank" rel="noopener noreferrer">https://www.sdcard.org查阅更多标准。SD卡主要有SD、Mini</a> SD和microSD(原名TF卡，2004年正式更名为Micro SD Card，为方便本文用microSD表示)三种类型，Mini SD已经被microSD取代，使用得不多，根据最新的SD卡规格列出的 参数如下所示：</p>
<p><img decoding="async" loading="lazy" alt="01" src="/assets/images/26-70b090a52ff9d233acba2caaa1913fd2.png" width="641" height="440" class="img_ev3q"></p>
<p>上述表格的“脚位数”，对应于实卡上的“金手指”数，不同类型的卡的触点数量不同，访问的速度也不相同。SD卡允许了不同的接口来访问它的内部存储单元。最常见的是SDIO模式和SPI模式，根据这两种接口模式，我们也列出SD卡引脚对应于这两种不同的电路模式的引脚功能定义，如下所示：</p>
<p><img decoding="async" loading="lazy" alt="01" src="/assets/images/27-fabb03147966b4e89698e5375b86f421.png" width="668" height="276" class="img_ev3q"></p>
<p>我们对比着来看一下microSD引脚，可见只比SD卡少了一个电源引脚VSS2，其它的引脚功能类似。</p>
<p><img decoding="async" loading="lazy" alt="01" src="/assets/images/28-fd937186529ba9ef233e9c317e2538f2.png" width="655" height="248" class="img_ev3q"></p>
<p>SD卡和Micro SD只有引脚和形状大小不同，内部结构类似，操作时序完全相同，可以使用完全相同的代码驱动，下面以9’Pin SD卡的内部结构为为例，展示SD卡的存储结构。</p>
<p><img decoding="async" loading="lazy" alt="01" src="/assets/images/29-2522201a0d281373fcd23f1888ee90df.png" width="379" height="520" class="img_ev3q"></p>
<p>SD卡有自己的寄存器，但它不能直接进行读写操作，需要通过命令来控制，SDIO协议定义了一些命令用于实现某一特定功能，SD卡根据收到的命令要求对内部寄存器进行修改。下图中描述的SD卡的寄存器是我们和SD卡进行数据通讯的主要通道，如下：</p>
<p><img decoding="async" loading="lazy" alt="01" src="/assets/images/30-8c896861ca661f8c3ff6aff5f34ddfe5.png" width="592" height="292" class="img_ev3q"></p>
<p>关于SD卡的更多信息和硬件设计规范可以参考SD卡协议《Physical Layer Simplified Specification Version 2.00》的相关章节。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="硬件设计">硬件设计<a href="#硬件设计" class="hash-link" aria-label="硬件设计的直接链接" title="硬件设计的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="例程功能">例程功能<a href="#例程功能" class="hash-link" aria-label="例程功能的直接链接" title="例程功能的直接链接">​</a></h3>
<ol>
<li>本章实验功能简介：经过一系列初始化之后，通过一个while循环以SD卡初始化为条件，以检测SD卡是否初始化成功，若初始化SD卡成功，则会通过串口或者VSCode终端输出SD卡的相关参数，并在LCD上显示SD卡的总容量以及剩余容量。此时LED闪烁，表示程序正在运行。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="硬件资源">硬件资源<a href="#硬件资源" class="hash-link" aria-label="硬件资源的直接链接" title="硬件资源的直接链接">​</a></h3>
<ol>
<li>
<p>LED:
LED-GPIO3</p>
</li>
<li>
<p>正点原子1.14寸SPI LCD模块</p>
</li>
<li>
<p>SD（采用SPI接口协议）</p>
<p>SDIO_SCK-GPIO10(SCK)</p>
<p>SDIO_CMD-GPIO11(MOSI)</p>
<p>SDIO_D0-GPIO12(MISO)</p>
<p>SDIO_D1-GPIO13(该引脚可用作模拟SDIO接口协议，在该例程中未用到)</p>
<p>SDIO_D2-GPIO14(该引脚可用作模拟SDIO接口协议，在该例程中未用到)</p>
<p>SDIO_D3-GPIO15(CS)</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="原理图">原理图<a href="#原理图" class="hash-link" aria-label="原理图的直接链接" title="原理图的直接链接">​</a></h3>
<p>着重说明：本章实验使用SPI接口协议与SD卡进行连接，为了保证例程的可拓展性，作者在硬件上多引出了GPIO13与GPIO14两个引脚，这两个引脚可以用于在PIO机制中对SDIO接口协议进行模拟。因此，对于SD卡的驱动来说，SDK版本有着两种方式进行驱动（一种SPI，一种通过PIO机制模拟SDIO）。开发板板载了一个Micro SD卡座用于连 接SD卡，SD卡与RP2350A的连接原理图，如下图所示：</p>
<p><img decoding="async" loading="lazy" alt="01" src="/assets/images/31-765a338bda299ac76cffc10984b0964a.png" width="1042" height="502" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="程序设计">程序设计<a href="#程序设计" class="hash-link" aria-label="程序设计的直接链接" title="程序设计的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spi_sd卡函数解析">SPI_SD卡函数解析<a href="#spi_sd卡函数解析" class="hash-link" aria-label="SPI_SD卡函数解析的直接链接" title="SPI_SD卡函数解析的直接链接">​</a></h3>
<p>PICO-SDK提供了丰富的SPI接口函数，开发者可以在<code>pico-sdk\src\rp2_common\hardware_spi</code>路径下找到相关的spi.c和spi.h文件。在spi.h头文件中，你可以找到RP2350A的所有SPI函数定义。接下来，作者将介绍一些常用的SPI函数，这些函数的描述及其作用如下：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="spi初始化函数">SPI初始化函数<a href="#spi初始化函数" class="hash-link" aria-label="SPI初始化函数的直接链接" title="SPI初始化函数的直接链接">​</a></h4>
<p>该函数的作用是对指定的SPI（Serial Peripheral Interface，串行外设接口）实例进行初始化，同时设置其波特率,其函数原型如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uint spi_init(spi_inst_t *spi, uint baudrate)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【参数】</p>
<ol>
<li>spi_inst_t *spi: spi_inst_t类型的指针，用于指定要初始化的SPI实例</li>
<li>uint baudrate: 一个uint类型的参数，用于指定期望的波特率</li>
</ol>
<p>【返回值】</p>
<ol>
<li>baud：函数最终返回实际设置的波特率</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="设置spi数据传输格式函数">设置SPI数据传输格式函数<a href="#设置spi数据传输格式函数" class="hash-link" aria-label="设置SPI数据传输格式函数的直接链接" title="设置SPI数据传输格式函数的直接链接">​</a></h4>
<p>该函数用于设置SPI（串行外设接口）实例的数据传输格式,其函数原型如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">void spi_set_format(spi_inst_t *spi, uint data_bits, spi_cpol_t cpol, spi_cpha_t cpha, __unused spi_order_t order)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【参数】</p>
<ol>
<li>spi_inst_t *spi: 这是一个 spi_inst_t 类型的指针spi以指定要配置的SPI实例</li>
<li>uint data_bits: 数据位宽</li>
<li>spi_cpol_t cpol:时钟极性</li>
<li>spi_cpha_t cpha:时钟相位</li>
<li>spi_order_t order:数据传输顺序</li>
</ol>
<p>【返回值】</p>
<ol>
<li>无</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="spi数据写入函数">SPI数据写入函数<a href="#spi数据写入函数" class="hash-link" aria-label="SPI数据写入函数的直接链接" title="SPI数据写入函数的直接链接">​</a></h4>
<p>该函数用于通过 SPI（串行外设接口）以阻塞方式向外部设备写入数据。该函数会持续等待，直到数据成功写入SPI总线，并且会处理写入过程中的一些状态和异常情况,其函数原型如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int spi_write_blocking(spi_inst_t *spi, const uint8_t *src, size_t len)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【参数】</p>
<ol>
<li>spi_inst_t *spi: 这是一个 spi_inst_t 类型的指针spi以指定要配置的SPI实例</li>
<li>const uint8_t *src: 指向 uint8_t 类型的常量指针 src 用于指定要写入的数据的源地址</li>
<li>size_t len: size_t 类型的参数 len 用于指定要写入的数据长度</li>
</ol>
<p>【返回值】</p>
<ol>
<li>(int)len:实际写入的数据长度</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="spi数据写入函数-1">SPI数据写入函数<a href="#spi数据写入函数-1" class="hash-link" aria-label="SPI数据写入函数的直接链接" title="SPI数据写入函数的直接链接">​</a></h4>
<p>该函数用于通过 SPI（串行外设接口）以阻塞方式向外部设备写入数据。该函数会持续等待，直到数据成功写入SPI总线，并且会处理写入过程中的一些状态和异常情况,其函数原型如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int spi_write_blocking(spi_inst_t *spi, const uint8_t *src, size_t len)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【参数】</p>
<ol>
<li>spi_inst_t *spi: 这是一个 spi_inst_t 类型的指针spi以指定要配置的SPI实例</li>
<li>const uint8_t *src: 指向 uint8_t 类型的常量指针 src 用于指定要写入的数据的源地址</li>
<li>size_t len: size_t 类型的参数 len 用于指定要写入的数据长度</li>
</ol>
<p>【返回值】</p>
<ol>
<li>(int)len:实际写入的数据长度</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spi_sd卡驱动解析">SPI_SD卡驱动解析<a href="#spi_sd卡驱动解析" class="hash-link" aria-label="SPI_SD卡驱动解析的直接链接" title="SPI_SD卡驱动解析的直接链接">​</a></h3>
<p>在SDK版本的14_sdio例程中，作者在<code>14_sdio\BSP</code>路径以及<code>Middlewares</code>路径下分别新增了两个文件夹一个是<code>SDIO</code>,一个是<code>FatFs_SPI</code>。前者用于存放spi_sdcard.c和spi_sdcard.h这两个文件，后者用于存放便于系统调用的第三方SD卡库。其中，spi_sdcard.h文件负责声明与SD卡相关的函数和变量，spi_sdcard.c文件实现了SD卡的驱动代码。另外，值得一提的是，PICO-SDK并没有直接提供与SD卡相关的API，因此作者引入了除官方外的一个第三方库。这一个第三方库将SD卡驱动时所需要用到的命令与驱动步骤进行了一个封装，我们只需调用封装好的函数即可。下面，我们将详细解析这两个文件的实现内容。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1spi_sdcardc文件">1，spi_sdcard.c文件<a href="#1spi_sdcardc文件" class="hash-link" aria-label="1，spi_sdcard.c文件的直接链接" title="1，spi_sdcard.c文件的直接链接">​</a></h4>
<p>sd_init的设计就比较简单了，函数首先获取SD卡实例，然后配置文件系统挂载。根据外设的情况，我们可以设置SPI的使用端口为SPI1端口。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static sd_card_t *pSD = NULL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       定义SPI硬件配置数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @details     每个SPI的硬件配置信息存储在该数组中，多个SD卡可由一个SPI驱动，只要使用不同的从设备选择引脚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @note        目前只定义了一个SPI的配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static spi_t spis[] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .hw_inst = spi1,                /* 使用的SPI硬件实例,指定为spi1 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .miso_gpio = 12,                /* SPI的MISO引脚对应的GPIO编号,注意这里是GPIO编号而非引脚编号 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .mosi_gpio = 11,                /* SPI的MOSI引脚对应的GPIO编号 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .sck_gpio = 10,                 /* SPI的SCK引脚对应的GPIO编号 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .baud_rate = 25 * 1000 * 1000,  /* SPI的波特率 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       定义SD卡硬件配置数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @details     每个SD卡的硬件配置信息存储在该数组中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @note        目前只定义了一个SD卡的配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static sd_card_t sd_cards[] = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .pcName = &quot;0:&quot;,             /* SD卡挂载时使用的名称，用于标识该SD卡设备 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .spi = &amp;spis[0],            /* 指向驱动该SD卡的SPI对象的指针，表明该SD卡由spis数组中的第一个SPI对象驱动 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .ss_gpio = 15,              /* 该SD卡的SPI从设备选择引脚对应的GPIO编号，用于选中该SD卡进行通信 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .use_card_detect = false,   /* 是否使用卡检测功能,false表示不使用卡检测功能 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .card_detect_gpio = -1,     /* 卡检测引脚对应的GPIO编号,由于不使用卡检测功能，设置为 -1 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .card_detected_true = 1     /* 当使用卡检测功能时，卡存在时GPIO读取的值,这里由于不使用卡检测功能，该值无实际意义 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       获取SD卡对象的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param       无</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @retval      size_t : SD卡对象的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">size_t sd_get_num() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return count_of(sd_cards);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       根据编号获取对应的SD卡对象指针</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param       num : SD卡的编号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @retval      sd_card_t* : 对应的SD卡对象指针，若编号超出范围则返回NULL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sd_card_t *sd_get_by_num(size_t num) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (num &lt; sd_get_num()) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &amp;sd_cards[num];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NULL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       获取SPI对象的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param       无</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @retval      size_t : SPI对象的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">size_t spi_get_num() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return count_of(spis);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       根据编号获取对应的SPI对象指针</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param       num : SPI的编号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @retval      spi_t* : 对应的SPI对象指针，若编号超出范围则返回NULL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spi_t *spi_get_by_num(size_t num) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (num &lt; spi_get_num()) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &amp;spis[num];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NULL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       SD卡初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param       无</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @retval      esp_err_t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void sd_init(uint32_t *free, uint32_t *total)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pSD = sd_get_by_num(0);     /* 获取SD卡实例 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint8_t fr = f_mount(&amp;pSD-&gt;fatfs, pSD-&gt;pcName, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (FR_OK != fr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        panic(&quot;f_mount error: %s (%d)\n&quot;, FRESULT_str(fr), fr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint32_t fre_clust = 0, fre_sect = 0, tot_sect = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FATFS *fs;                  /* FatFs文件系统结构体 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fr = f_getfree(pSD-&gt;pcName, &amp;fre_clust, &amp;fs);   /* 获取剩余空间（单位：簇） */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (FR_OK == fr)            /* 计算剩余空间（单位：字节） */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fre_sect = fre_clust * fs-&gt;csize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tot_sect = (fs-&gt;n_fatent - 2) * fs-&gt;csize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        *free = fre_sect &gt;&gt; 1;	/* 单位为KB */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        *total = tot_sect &gt;&gt; 1;	/* 单位为KB */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printf(&quot;f_getfree error: %s (%d)\n&quot;, FRESULT_str(fr), fr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f_unmount(pSD-&gt;pcName);     /* 卸载文件系统 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cmakeliststxt文件">CMakeLists.txt文件<a href="#cmakeliststxt文件" class="hash-link" aria-label="CMakeLists.txt 文件的直接链接" title="CMakeLists.txt文件的直接链接">​</a></h3>
<p>打开本章节的实验（14_sdio），在整个工程文件下包含了一个CMakeLists.txt文件。此文件的作用是将BSP文件夹下的驱动程序添加到构建系统中，确保在编译项目工程时能够调用这些驱动程序。关于该实验的CMakeLists.txt文件的具体内容与上一章节并没有什么太大的不同，因此不再赘述。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实验应用代码">实验应用代码<a href="#实验应用代码" class="hash-link" aria-label="实验应用代码的直接链接" title="实验应用代码的直接链接">​</a></h3>
<p>打开main.c文件，该文件定义了工程入口函数，名为main。该函数代码如下。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @brief       程序入口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param       无</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @retval      无</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   uint8_t t = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   uint32_t free, total;               /* SD卡的总空间与剩余空间 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   stdio_init_all();                   /* 初始化标准库 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   led_init();                         /* 初始化LED */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   spi1_init();                        /* 初始化SPI1 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_init();                         /* 初始化LCD */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   sd_init(&amp;free, &amp;total);             /* 初始化SD卡 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_string(0, 0, 240, 32, 32, &quot;RP2350A&quot;, RED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_string(0, 33, 240, 24, 24, &quot;SD TEST&quot;, RED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_string(0, 60, 240, 16, 16, &quot;ATOM@ALIENTEK&quot;, RED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_string(0, 80, 240, 16, 16, &quot;SD Free Size:       MB&quot;, RED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_string(0, 100, 240, 16, 16, &quot;SD Total Size:      MB&quot;, RED);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_num(113 , 80, (int)free &gt;&gt; 10, 5, 16, BLUE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lcd_show_num(113, 100, (int)total &gt;&gt; 10 ,5,16, BLUE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   while (1) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       LED_TOGGLE();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       sleep_ms(200);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以看到，本实验的应用代码中，通过初始化SD卡判断与SD卡的连接是否有误，SD卡初始化成功后便通过函数sd_get_fatfs_usage()获取容量等信息，同时也在LCD上显示了SD的容量信息。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="下载验证">下载验证<a href="#下载验证" class="hash-link" aria-label="下载验证的直接链接" title="下载验证的直接链接">​</a></h2>
<p>程序下载到开发板后，可以看到LCD显示SD卡总容量与剩余容量，LED灯闪烁。如下图所示：</p>
<p><img decoding="async" loading="lazy" alt="01" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOQAAABuCAYAAAA3fL8zAAAABWZkRUNSJJPjAOWrYpkAABjPSURBVHgB5cRjtCVn2oDh+3mravPY57RtxLYzM0kGydi2bdu2EYxi22bbPH2szap6n2/Vj7PWXr06mWimZ773x3Whquoyl7nsv5UBcJnLXPbfygC4zGUu+29lAFzmMpf9tzIALnOZy/5bGQCXucxl/60MgMtc5rL/VgbgyWDTLxibNo+hafPYl6HnPJ+Jn15PDACw6ReMTZvH0LR57MvQc57PxE+vJwYAJsFmqu9/PmPT5jE0bR6Thp7zfCau3QxALdhM9f3PZ2zaPIamzWPS2PuvJwYAasU/fT5D0+bxeIbefz0Atdj0CyaeM4+hafNIDE17PmPvv54YANgXNv2CsWnzGJo2j7GfbgbAZS57KgzAk8HsN9Cw/WpyywHA/8TVtGxfT8v2q2n89QvwH36U6hfezOj7rweA2W+gYftPSQEAqV+vp2X7ehKNN/2UFI9S/cKbGX3OL4gBALieiWmnMnEBmF9fTcv29bRsv5q6TyyFhx+l+tpTGfvpZgASsJnyc05l4oJHMb++mpbt62m56afklkN0wZsZfc4viAGASfG6+aTOewF1N11N401Xs7fGb54IwCQ2/YKx475K9WHwP/FTGm+6mtzyR4kueDOjz/kFMQCwt/iay4gAgGjdZgBc5rKnwgA8EzAL7+Sv0vDrFwDABVdRBQAejzf7ROq+/2F8gIe/SulaAIh/+n2qAOe9k7qTZwEAs0i9+e/UnQcA0cXXEQMAXPsTig8DvIDUybMAYPaJZL7/YXyAh79K6VoA2BuzZ+HNnsXePAAgAZspv/OrRADn/ZSGN5+IN3sWmct+Sgrg4a9SuhYAasFmwosfBSDBBVdRBQBc5rInywA8G5g9Dx+AddhNAPBEmH0SqeUAYDduBiBe9ygAXPB9ypsAYJI3fykAPLyeGADg5NNILV+Kv3wddhMAJJh9EqnlAPBMcO1PKD4MsJTc208EIAEnkjoPAKrf/gUxADAJNhOxFP+8F5AC4G9UrwUAl7nsyTIAzwY2rScCYD5mNgA8Vam3/5TUeS8gdd5zCGYDwN5YPg8PAIATqbvs7zRc9ncyswEgwabrqD4MsBR/NgAkYDMWgHl4AMATqV7xNwBgPmY2AEzy5i8FgIcvI9wEAJO49iqqDz+KOeOrpM4DgOoV1wPgMpc9WQbgmYDNxNd+mLHX/g2A1K+/SgoAeCJsuo7qwwBg5swCgNknUvfNr1L3zTfgAQAJ2Ex48aMApN77BjwAYF/iTdcz8c6vErGU1K//TmY2ANRizWWUnvN8hqbNY9LQcz5MeRMAJGAzdg0AsHweHgAwyZszH4B9qV6xDn/5UvzZkDrjBQCwZhMxAOAylz0ZBuDpiL5wKkPT5jE07VRGX/s3WP4C6m5aT93JAPBE4mt/wdhxXyUCOO+n1J0MAI8n/un7KD4M/nk/pe5kANhb/NPnMzRtHqPHvZnqw0tJ/fpb1J0MALVgHfbhR6kyn7qb1tOyfT2Nv34BPPw3isfNY+JaAKjFwtl4AMDe4FGiTQCQgM1Y5mMWPodgNjB7Hj7Aw5cRbgIAl7nsyTAAT4f/iatpuenD+AAsJfX9r5KaDQD7Un3tPIamzSMx+tqvEi1fSuoTP6XxmycC8Hjiaz9M4QuP4n/iahq+eSIA++K9+e+0bF9Py01XkzsPqq89laHn/IIYAJgUzH8OqU/8lMbLvkpqNgB4J3+VuvMAoPrtXxADAE8Hm66jesHfsPNPwgOYfRKp5QCPUr1mMwAuc9mTYQCeLmafRGo5wKMUf3g9AI8n9ev1tGxfz6SWy/5O3ZtPxAMA9iX+6fMZfe06zK+vpuHNswD4V5g9i8w3v0VuOfDwVxl9//UAJGAW3pvfQObNJ+IBAJNSZ7wAAB5eTwzALMxCAGDNJmIAYG+wFH82ACTiay4jAqIvnMrQtHkMTTuV4sMAEK3bDIDLXPZkGICnC2aRee8LAOCCNzNxLQA8U7CZ6vvnMfoFyN30d+pOngXAkwWzCM5aCgAXXEUVAEiwaTPxJgB4snh4PTEAMCneuA4AmI+ZDQCwmfBi8Je/gLrt62nZvp5E4yeWAsAFV1EFAFzmsn/FADwTnPwWcssBoPrtXxADAE8XbKb8nFOZuGApuZv+TmY2ACTYtJnqtdcTAwBs+gUTz3k+Y8/5MOVNAPBE4p8+n6HjTmX0uHlMXAsATyR1xgsAgHXYTQAwKV73KAAsn4cHAMBmIoCFp5ECABLeKc/BB+BvVK8FAJe57F8xAM8EzCLz3hcAwMNfpXQtADwdsJnyc06l+PBScjf9ncxsAJhU/eH7KH/7+4SbACC+5jKqDz9K9PA6ACbBZsKLHwWA804jBQBMgheQOhkAJlWv+BsAnHcaKQCAk99CbjnAoxR/eD0ACbie6gUAkHrvG/AAAK69iurDj2LOOBGAScw+idRyALAbNwPgMpf9KwbgmeLkt5BbDgDVb/+CGAB4qqrvfx/Fh5eS+vW3CNhMvGkzk+KffpiJCx4leng+ZjYAeKc8Bx+AR4k2bQYANlN9//soPgywlNzbTwQg4b35naQAWEf12s3EAGym+v7nM3EBwFJybz8RgATMIvP9D+MDXPBmxn66mXjT9ZSf82aqAOf9lLqTASBRveJvAOwNZhGctRSA6As/oQoAuMxlT8QAPBls+gVj006l+DAARF84laH3Xw8AzCI4aykAPPxVRqc9n/JPP8zQtDdTBQCqr53H0PuvB2Bf4HqqFzwKPEr1tacyetyp1Br9wt8AYPk8PACA2W+g4aafkjtvKdXXnsrQtHkMTTuViQvAP+/D1N30dzKzASABJ1K3/WrqzgP72lMZnTaPoWmnMnHBo/jLX0DdTX8nMxsAJjH7DTTc9GFSyyH6wqmMHvdmig8vxf/ET2n85okAwGbKz5nHxAUAUH3tPCauBYBE/NPnM/qFRwGAvzEx7fmUNwGAy1z2eAzAk8HsN9CwfT0t29czqeWbJwKQ8N78d1q2ryfRsv3vZN78VVq2r6dWyzdPBGBf4ETqtq+nZft6nkjLZW/AAwASzD6RzDf/Tsv29Uxq2f53Gr75BlKzAaAWzCL1zb/TsH09LdvXM6nhsq+Smg0Ae2P2G6i7bD0t29eTaNn+dxrefCIeAACzyFy2npbt65lUdzIAJLw3/52W7euZ1LL972RmA4DLXPZ4DIDLXOay/1YGwGUuc9l/KwPgMpe57L+VAXCZy1z238oAuMxlLvtvZQBc5jKX/bcyAC5zmcv+WxkAl7nMZf+tDIDLXOay/1YGwGUuc9l/KwPwVAxNm8e+AAxNm8e+ADwVQ9Pm8UQAhqbN4/EA1BqaNo99ARiaNo8nAuAyl+0PBuDJGpo2D4CW7euZBDCpZft6ABIt29eTABiaNg+Ap6pl+3oAEi3b1wMwqWX7egASLdvXMwlgaNo8ABJD0+YB0LJ9PZMA9tayfT0AiZbt6wFwmcv2JwPw79SyfT0AQ9PmAfBktGxfTwKgVsv29SQA9jY0bR6Jlu3rSQA8GS3b15MAqNWyfT0JAJe5bH8wAM9Ey/b1JAD+V7RsX08CwGUu+29lAJ6slu3rARiaNg+A/xZD0+YBsC8t29cDMDRtHgAuc9n/CgPwVLRsXw/A0LR5JAD2t5bt6wF4PC3b1wMwNG0eCQCXuey/nQF4qlq2rycBMDRtHgD/7Vq2rycBMDRtHgAuc9l/MwPwdLVsXw/A0LR5AOxPLdvXkwB4Ii3b1wMwNG0eAC5z2X8rA/BkDU2bRwLgv9XQtHkkABJD0+aRAHCZy/6XGIB/p6Fp8wBo2b4eAJe5zGVPhQF4qoamzWMSQMv29QAMTZsHQGJo2jwSAC3b1wPwVA1NmwdAYmjaPAAmDU2bB0BiaNo8JgG0bF8PQK2hafOYBNCyfT0Ak4amzQMgMTRtHgAuc9n+ZACerJbt69kXgETL9vXsC8DT0bJ9PbUAJrVsX8/jAZjUsn09+wJQq2X7emoBuMxl+5MBcJnLXPbfygC4zGUu+29lAFzmMpf9tzIALnOZy/5bGQCXucxl/60MgMtc5rL/VgbAZS5z2X8rA/BUDU2bRwKg1tC0eewLwKShafOYBDBpaNo8nghAYmjaPPYGUGto2jwSAJOGps2jFsDehqbNY18AhqbN4/EADE2bxxMBGJo2j30BGJo2j8cDMDRtHo8HwGX/nxiA/5ShafMAaNm+HoChafMASLRsXw/AvrRsXw/A0LR5ALRsX88kgKFp8wB4Ii3b1wOQaNm+HoC9tWxfTwIg0bJ9PQmAlu3rAUi0bF9PAmBSy/b1AExq2b4egETL9vUAPJGW7esBSLRsX08CYFLL9vUAJFq2rwcg0bJ9PQAu+//EADwVQ9PmAZAYmjYPgEkt29eTAEi0bF9PAmBo2jwAWravB6Bl+3oAhqbNA+BfGZo2D4CW7esZmjaPSQC1hqbNAyAxNG0eAP8uLdvXkwB4Mlq2rycBkGjZvp4EwL60bF9PAqDW0LR5ALRsXw+Ay/6/MQD/S4amzQNgfxuaNo8EwL4MTZsHwNM1NG0eCYB9adm+HgCX/X9kAFz2dAxNmwfAv8vQtHkAPJGhafMAcNn/RwbAZU9Hy/b1APy7tGxfD4DLXGUAnqyhafMAaNm+ngTA0LR5APyntGxfD0Ctlu3rARiaNg+Alu3rSQAMTZsHwLOtZft6EgB7a9m+HoBnomX7ehIAe2vZvh6AoWnzAHDZ/zcG4D+hZft6AIamzQNgaNo8AFq2rwfgX2nZvh6AoWnzaNm+nkkAQ9PmAfBUDU2bRwLg6RiaNo8EwL/D0LR5JABc5hID8GQMTZsHQGJo2jwSAImhafMASAxNmwdAYmjaPAAmtWxfD8DQtHkAtGxfD0BiaNo8APZlaNo8AFq2rwdgaNo8JgG0bF/P0LR5ACSGps0jAZAYmjaPBEBiaNo8EgC1hqbNIwGQGJo2jwTA0LR5ACSGps0jATBpaNo8ABJD0+bRsn09AHsbmjYPgMTQtHkAJIamzQMgMTRtHgmASUPT5gGQGJo2D4DE0LR5ALjs/xMD8GS0bF/PEwFItGxfTy2AWi3b1zMJYFLL9vU8EYBEy/b17A2gZft6ni6ARMv29ewLQMv29TwegJbt66kF0LJ9PQmASS3b11MLINGyfT2PB6Bl+3oeD4DL/j8xAC5zmcv+WxkAl7nMZf+tDIDLXOay/1YGwGUuc9l/KwPgMpe57L+VAXCZy1z238oAuMxlLvtvZQCeiqFp89gbwNC0eewN4MkamjaPxwPw32Jo2jz2BlBraNo8EgD/a44/4z5qAezt+DPuYxJArePPuI9aAHs7/oz7mATwZAxNm8fTAfC/xAA8WUPT5gHQsn09CYBJLdvXA5Bo2b4egKFp8wB4Mlq2rwcg0bJ9PQmA/yZD0+YB0LJ9PQmAfWnZvp4EwP+S48+4D4AbrziIBMDxZ9wHwKTjz7gPgBuvOAiA48+4D4DE8WfcB8CNVxxEAuD4M+4DYNLxZ9wHwI1XHATA8WfcB8C/0rJ9PQD70rJ9PQmARMv29SQAhqbNA+B/hQF4ulq2rycBsLeW7esBGJo2D4Cno2X7ehIA/41atq8nAfD/wY1XHEQCYF+OP+M+AG684iAAbrziIBIAiRuvOIgEwL4cf8Z9ANx4xUEA3HjFQSQAXFbLADxZLdvXAzA0bR4A/05D0+aRAJg0NG0e+wIwaWjaPGoB1BqaNo9aAE9Wy/b1AAxNmwfA3oamzaMWQK2hafPYF4BJQ9PmUQug1tC0eSQA9pfjz7iPSQBP1fFn3MckAJftzQA8FS3b1wMwNG0eCYBn29C0eQDsrWX7egAmtWxfTwIgMTRtHgAt29eTABiaNg+AxNC0eQC0bF9PAmBo2jwAnqyW7esBGJo2jwTApJbt60kAPJGW7esBSLRsXw9AYmjaPABatq8nATA0bR4Ak1q2rycB8O9y/Bn3kQC48YqDANjbjVccBMDxZ9wHQK3jz7iPBMCNVxwEwN5uvOIgAI4/4z4Ank1D0+aRAGjZvh6A/xUG4Klq2b6eBMDQtHkAPJtatq8H4Im0bF8PwL4MTZtHAmBfhqbNIwHwdLRsX08CYGjaPACejJbt60kMTZsHQMv29QDsbWjaPBIA+8ONVxxEAuD4M+4DoNaNVxwEwOO58YqDSAAcf8Z9ANS68YqDAPh3adm+ngTA0LR5APyvMAD/jVq2rycB8FS1bF9PLYBaLdvXUwvgv0nL9vXUAnCZSwzAkzU0bR4JgH9laNo8AFq2rwdgfxiaNo8EwL4MTZtHAuDJGJo2jwTA0zU0bR4ALdvXMzRtHgmAfRmaNo8EwH/C8WfcRwLg6Tj+jPtIALjsmTAAT9XQtHkkAFq2rwdgaNo8ABJD0+YB0LJ9PQBPxtC0eQAkhqbNA2BvQ9PmAZAYmjaPBMCklu3rARiaNo8EQMv29QAkWravB2Bo2jwSAC3b1wPwVAxNm0cCoGX7egASQ9PmkQBIDE2bRwIgMTRtHgCJoWnzAKjVsn09AEPT5pEAaNm+HoBJQ9PmkQB4tt14xUEAHH/GfSQAbrziIAASN15xEADHn3EfCYAbrzgIgMSNVxwEwPFn3EcC4MYrDgIgceMVBwFw/Bn3kQC48YqDAPhXhqbNA2BfhqbNIwGQGJo2jwRAy/b1APyvMABPVsv29ewNINGyfT17A3iyWravpxbA3lq2r2dvALVatq+nFkCtlu3rqQXwZLVsX8/eACa1bF/PvgAkWravZ18AJrVsX08tgFot29eTAPh3uPGKg6gFUOvGKw6iFkCtG684iFoAtW684iBqATwZLdvX83QA/C8xAC5zmcv+WxkAl7nMZf+tDIDLXOay/1YGwGUuc9l/KwPgMpe57L+VAXCZy1z238oAuMxlLvtvZQCeiqFp89gbwNC0eewN4KkYmjaPfQH4TxiaNo9aAE/V0LR57A2g1tC0eSQA/tscf8Z91AKodfwZ91ELoNbxZ9xHLYC9HX/GfSQAnqyhafN4OgD+lxiAJ2to2jwAWravJwEwqWX7egASLdvXAzA0bR4A/0lD0+aRAHiqWravJwHwdAxNmwdAy/b1JAD2pWX7ehIA/02OP+M+AG684iASAMefcR8AiePPuA+AG684iATA8WfcB0Di+DPuA+DGKw4iAXD8GfcBMOn4M+4D4Klq2b4egH1p2b6eBECiZft6EgBD0+YB8L/CADxdLdvXkwDYW8v29QAMTZsHwJPRsn09CYBEy/b1JAD+F7VsX08C4H/BjVccRALg3+XGKw4CwGVPxAA8WS3b1wMwNG0eAPvD0LR51AJIDE2bRwIgMTRtHgmAWkPT5lEL4NnSsn09AEPT5gGwt6Fp86gFUGto2jz2BWDS0LR51AKoNTRtHgkAl/2vMgBPRcv29QAMTZtHAuA/ZWjaPABatq8nATA0bR4ALdvXkwBItGxfTwJg0tC0eQC0bF9PAmBo2jwAni0t29cDMDRtHgmASS3b15MAeCIt29cDkGjZvh6AxNC0eQC0bF9PAmBo2jwAJrVsX08C4Ok6/oz7SADceMVBACRuvOIgAI4/4z4SADdecRAA/02Gps0jAdCyfT0A/ysMwFPVsn09CYChafMA+F/Qsn09iaFp80gA/Du0bF9PAmBo2jwAnoyW7etJDE2bB0DL9vUA7G1o2jwSAP8ON15xEAmA48+4D4DE8WfcB8CNVxxEAuD4M+4D4L9Jy/b1JACGps0D4H+FAXDJ0LR5ALRsXw/A/6KW7eupBeCy/08MwJM1NG0eCYB/ZWjaPABatq8HYH8YmjaPBEBiaNo8AFq2rwfg2TY0bR4JgKdraNo8AFq2r2do2jwSAPsyNG0eCYBnw/Fn3EcCwGX7kwF4qoamzSMB0LJ9PQBD0+YBkBiaNg+Alu3rAXgqhqbNAyAxNG0eAJNatq8HYGjaPBIALdvXAzCpZft6AIamzQOgZft6ABIt29cDMDRtHgmAxNC0eQAMTZtHAiAxNG0eCYCnYmjaPBIALdvXA5AYmjaPBEBiaNo8EgCJoWnzAEgMTZsHQK2W7esBGJo2jwRAy/b1AEwamjaPBMBTdeMVBwFw/Bn3kQC48YqDAEjceMVBABx/xn0kAG684iAAEjdecRAAx59xHwmAG684CIBJx59xHwCJ48+4D4AnY2jaPAD2ZWjaPBIAiaFp80gAtGxfD8D/CgPwZLVsX8/eABIt29ezN4CnqmX7emoB1GrZvp5aAHtr2b6eSQC1WravZ18AWravZ18AnoyW7evZG8Cklu3r2ReARMv29ewLwKSW7eupBVCrZft6EgBPx41XHEQtgFo3XnEQtQBq3XjFQdQCqHXjFQdRC+DJaNm+nqcD4H+JAXCZy1z238oAuMxlLvtvZQBc5jKX/bcyAC5zmcv+WxkAl7nMZf+tDIDLXOay/1YGwGUuc9l/KwPgMpe57L+VAXCZy1z238oAuMxlLvtvZQBc5jKX/bcyAC5zmcv+WxkAl7nMZf+tDIDLXOay/1YGwGUuc9l/q/8DM/PPDq0rmnAAAAAASUVORK5CYII=" width="228" height="110" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/trng"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">TRNG随机数实验</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Boards/RaspberryPi/DNRP2350A/set-up-development-environment/example-sdk/usb"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">USB虚拟串口实验</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#sd卡简介" class="table-of-contents__link toc-highlight">SD卡简介</a><ul><li><a href="#1sd卡物理结构" class="table-of-contents__link toc-highlight">1，SD卡物理结构</a></li></ul></li><li><a href="#硬件设计" class="table-of-contents__link toc-highlight">硬件设计</a><ul><li><a href="#例程功能" class="table-of-contents__link toc-highlight">例程功能</a></li><li><a href="#硬件资源" class="table-of-contents__link toc-highlight">硬件资源</a></li><li><a href="#原理图" class="table-of-contents__link toc-highlight">原理图</a></li></ul></li><li><a href="#程序设计" class="table-of-contents__link toc-highlight">程序设计</a><ul><li><a href="#spi_sd卡函数解析" class="table-of-contents__link toc-highlight">SPI_SD卡函数解析</a></li><li><a href="#spi_sd卡驱动解析" class="table-of-contents__link toc-highlight">SPI_SD卡驱动解析</a></li><li><a href="#cmakeliststxt文件" class="table-of-contents__link toc-highlight">CMakeLists.txt文件</a></li><li><a href="#实验应用代码" class="table-of-contents__link toc-highlight">实验应用  代码</a></li></ul></li><li><a href="#下载验证" class="table-of-contents__link toc-highlight">下载验证</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://www.openedv.com/docs/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">资料下载中心<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://www.openedv.com/forum.php/" target="_blank" rel="noopener noreferrer" class="footer__link-item">开源电子网<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/openedv" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://zhengdianyuanzi.tmall.com/index.htm" target="_blank" rel="noopener noreferrer" class="footer__link-item">天猫<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://mall.jd.com/index-12003110.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">京东<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 ALIENTEK, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>